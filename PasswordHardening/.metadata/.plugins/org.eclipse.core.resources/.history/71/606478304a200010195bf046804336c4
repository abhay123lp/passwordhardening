package com.example.helloandroid;

import com.example.helloandroid.R;

import android.app.Activity;
import android.os.Bundle;
import android.provider.Settings;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.location.LocationManager;
import android.content.Context;
import android.content.Intent;
import android.app.AlertDialog;
import android.content.DialogInterface;

public class HelloAndroid extends Activity {
   private static final int REQUEST_CODE = 0;
   final Activity currentActivity = this;
/** Called when the activity is first created. */
   @Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.main);
       final LocationManager manager = (LocationManager) getSystemService(Context.LOCATION_SERVICE );
       if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
           buildAlertMessageNoGps();
       } 
       
       final Button start = (Button) findViewById(R.id.button1);
       start.setOnClickListener(new View.OnClickListener() {
       		public void onClick(View v) {
       			Intent startGPS = new Intent();
       			startGPS.setAction("com.example.helloandroid.start");
           		currentActivity.startService(startGPS);
       		}
       	});
       
       final Button stop = (Button) findViewById(R.id.button2);
       start.setOnClickListener(new View.OnClickListener() {
       		public void onClick(View v) {
       			Intent stopGPS = new Intent();
       			stopGPS.setAction("com.example.helloandroid.start");
           		currentActivity.stopService(stopGPS);
       		}
       	});
   }
   

 private void buildAlertMessageNoGps() {
   final AlertDialog.Builder builder = new AlertDialog.Builder(this);
   builder.setMessage("Yout GPS seems to be disabled, do you want to enable it?")
          .setCancelable(false)
          .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
              public void onClick(@SuppressWarnings("unused") final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                  launchGPSOptions(); 
              }
          })
          .setNegativeButton("No", new DialogInterface.OnClickListener() {
              public void onClick(final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                   dialog.cancel();
              }
          });
   final AlertDialog alert = builder.create();
   alert.show();
}
 
private void launchGPSOptions(){
	Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
	startActivityForResult(intent, REQUEST_CODE);
	
}
}